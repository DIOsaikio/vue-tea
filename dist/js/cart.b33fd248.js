"use strict";(self["webpackChunkvue_tea"]=self["webpackChunkvue_tea"]||[]).push([[949],{9109:function(t,s,a){a.r(s),a.d(s,{default:function(){return v}});var e=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"cart container"},[a("header",[a("i",{staticClass:"iconfont icon-fanhui",on:{click:t.goback}}),a("span",[t._v("购物车")]),a("span",{domProps:{textContent:t._s(t.isNav?"完成":"编辑")},on:{click:t.isNavBar}})]),t.cartlist.length>0?a("section",[a("div",{staticClass:"cart-title"},[a("van-checkbox",{attrs:{value:t.isCheckAll},on:{click:t.checkallFn}}),a("span",[t._v("商品")])],1),a("ul",t._l(t.cartlist,(function(s,e){return a("li",{key:e},[a("div",{staticClass:"check"},[a("van-checkbox",{on:{click:function(s){return t.CHECK_ITEM(e)}},model:{value:s.checked,callback:function(a){t.$set(s,"checked",a)},expression:"item.checked"}})],1),a("h2",[a("img",{attrs:{src:s.imgUrl,alt:""}})]),a("div",{staticClass:"goods"},[a("div",{staticClass:"goods-title"},[a("span",[t._v(t._s(s.goods_name)+" ")]),a("i",{staticClass:"iconfont icon-lajitong",on:{click:function(a){return t.delGoodsFn(s.id)}}})]),a("div",{staticClass:"goods-price"},[t._v("¥"+t._s(s.goods_price))]),a("van-stepper",{attrs:{integer:""},on:{change:function(a){return t.changeNum(a,s)}},model:{value:s.goods_num,callback:function(a){t.$set(s,"goods_num",a)},expression:"item.goods_num"}})],1)])})),0)]):a("section",[t._v(" 暂无数据 ")]),t.cartlist.length>0?a("footer",[a("div",{staticClass:"radio"},[a("van-checkbox",{attrs:{value:t.isCheckAll},on:{click:t.checkallFn}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isNav,expression:"!isNav"}],staticClass:"total"},[a("div",[t._v(" 共有 "),a("span",{staticClass:"total-active"},[t._v(t._s(t.total.num))]),t._v(" 件商品 ")]),a("div",[a("span",[t._v("总计：")]),a("span",{staticClass:"total-active"},[t._v("¥"+t._s(t.total.price.toFixed(2)))])])]),t.isNav?a("div",{staticClass:"order",on:{click:t.delGoodsFn}},[t._v("删除")]):a("div",{staticClass:"order",on:{click:t.goOrder}},[t._v("去结算")])]):t._e()])},i=[],c=(a(4114),a(9930)),o=a(3890),l=a(3518),n=a(1981),r={name:"CartView",data(){return{checked:!0,isNav:!1}},computed:{...(0,l.aH)({cartlist:t=>t.cart.list,selectlist:t=>t.cart.selectlist}),...(0,l.L8)(["isCheckAll","total"]),goodsList(){return this.selectlist.map((t=>this.cartlist.find((s=>s.id==t))))}},created(){this.getData()},methods:{...(0,l.PY)(["CART_LIST","CHECK_ITEM","INIT_ORDER"]),...(0,l.i0)(["checkallFn","delGoodsFn"]),goback(){this.$router.replace("/home")},async getData(){let t=await o.A.$axios({url:"/api/selectCart",method:"POST",headers:{token:!0}});console.log(t),t.data.success&&(t.data.data.forEach((t=>{t["checked"]=!1})),console.log(t.data.data),this.CART_LIST(t.data.data))},isNavBar(){this.isNav=!this.isNav},changeNum(t,s){o.A.$axios({url:"/api/updateNum",method:"POST",data:{num:t,id:s.id},headers:{token:!0}}).then((t=>{console.log(t)}))},goOrder(){if(this.selectlist.length>0){let t=[];console.log(this.cartlist),this.cartlist.forEach((s=>{this.selectlist.filter((a=>{a==s.id&&t.push(s)}))})),console.log(t),o.A.$axios({url:"/api/addOrder",method:"POST",headers:{token:!0},data:{orderlist:t}}).then((t=>{(0,n.A)(t.data.msg),console.log(t.data.data),t.data.success&&this.INIT_ORDER(t.data.data),this.$router.push({name:"Order",query:{detail:JSON.stringify(this.selectlist),goodslist:JSON.stringify(this.goodsList)}})}))}else(0,n.A)("请选至少选择一件商品进行结算")}},components:{Tabbar:c.A}},d=r,h=a(1656),u=(0,h.A)(d,e,i,!1,null,"70f23705",null),v=u.exports}}]);